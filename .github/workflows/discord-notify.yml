name: Discord Notify

on:
  push:
    branches: [ main ]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Send Discord Notification
        if: always()
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          REPO: ${{ github.repository }}
          ACTOR: ${{ github.actor }}
          COMMIT_MSG: ${{ github.event.commits[0].message }}
          COMMIT_URL: https://github.com/${{ github.repository }}/commit/${{ github.sha }}
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d "{
            \"embeds\": [{
              \"title\": \"üöÄ Push to main\",
              \"color\": 3447003,
              \"fields\": [
                { \"name\": \"üì¶ Repo\", \"value\": \"$REPO\", \"inline\": true },
                { \"name\": \"üë§ By\", \"value\": \"$ACTOR\", \"inline\": true },
                { \"name\": \"üìù Commit\", \"value\": \"$COMMIT_MSG\" },
                { \"name\": \"üîó Link\", \"value\": \"[View Commit]($COMMIT_URL)\" }
              ]
            }]
          }" $DISCORD_WEBHOOK
